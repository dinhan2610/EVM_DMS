# ğŸ“Š HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng TÃ­nh NÄƒng Quáº£n LÃ½ Báº£ng KÃª

## âœ¨ Tá»•ng Quan

Há»‡ thá»‘ng quáº£n lÃ½ Báº£ng KÃª CÃ´ng Ná»£ vá»›i 3 tÃ­nh nÄƒng killer:

### 1. ğŸ“¥ Excel Import (KÃ©o & Tháº£)
- Drag & drop file Excel trá»±c tiáº¿p
- Tá»± Ä‘á»™ng parse vÃ  validate dá»¯ liá»‡u
- Hiá»ƒn thá»‹ visual feedback khi kÃ©o file

### 2. ğŸ”„ Auto-Fetch CÃ´ng Ná»£ TrÆ°á»›c
- Click nÃºt "Táº£i dá»¯ liá»‡u ná»£ trÆ°á»›c" 
- Tá»± Ä‘á»™ng láº¥y sá»‘ ná»£ cá»§a khÃ¡ch hÃ ng tá»« ká»³ trÆ°á»›c
- Loading spinner hiá»ƒn thá»‹ tráº¡ng thÃ¡i

### 3. âš¡ Real-time Calculations
- Tá»± Ä‘á»™ng tÃ­nh **ThÃ nh tiá»n** = Sá»‘ lÆ°á»£ng Ã— ÄÆ¡n giÃ¡
- Tá»± Ä‘á»™ng tÃ­nh **Tiá»n thuáº¿** = ThÃ nh tiá»n Ã— Thuáº¿ suáº¥t GTGT
- Tá»± Ä‘á»™ng tÃ­nh **Tá»•ng cá»™ng** = Tiá»n hÃ ng + Tiá»n thuáº¿ + CÃ´ng ná»£ trÆ°á»›c
- Cáº­p nháº­t ngay láº­p tá»©c khi chá»‰nh sá»­a

---

## ğŸš€ CÃ¡ch Sá»­ Dá»¥ng

### A. Truy Cáº­p Trang

1. ÄÄƒng nháº­p há»‡ thá»‘ng
2. VÃ o menu: **Quáº£n lÃ½ Báº£ng kÃª cÃ´ng ná»£**
3. Click nÃºt: **"Táº¡o Báº£ng kÃª má»›i"**

### B. Äiá»n ThÃ´ng Tin (Section A - Header)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¤ KhÃ¡ch hÃ ng*: [Autocomplete]                  â”‚
â”‚ ğŸ“… Ká»³ cÆ°á»›c*:    [Month Picker]                  â”‚
â”‚ ğŸ’° CÃ´ng ná»£ trÆ°á»›c: [Number] + [ğŸ”„ Táº£i tá»± Ä‘á»™ng]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**HÆ°á»›ng dáº«n:**
- **KhÃ¡ch hÃ ng**: GÃµ tÃªn hoáº·c MST â†’ chá»n tá»« danh sÃ¡ch
- **Ká»³ cÆ°á»›c**: Chá»n thÃ¡ng/nÄƒm (máº·c Ä‘á»‹nh: thÃ¡ng hiá»‡n táº¡i)
- **CÃ´ng ná»£ trÆ°á»›c**: 
  - Nháº­p thá»§ cÃ´ng HOáº¶C
  - Click nÃºt ğŸ”„ Ä‘á»ƒ táº£i tá»± Ä‘á»™ng

### C. Nháº­p Dá»¯ Liá»‡u (Section B - Body)

#### ğŸ¯ CÃ¡ch 1: Nháº­p Excel (Khuyáº¿n nghá»‹)

**Äá»‹nh dáº¡ng file Excel:**

| A (TÃªn hÃ ng hÃ³a/DV) | B (ÄÆ¡n vá»‹) | C (Sá»‘ lÆ°á»£ng) | D (ÄÆ¡n giÃ¡) | E (Thuáº¿ suáº¥t) | F (Ghi chÃº) |
|---------------------|------------|--------------|-------------|---------------|-------------|
| CÆ°á»›c ADSL thÃ¡ng 11  | ThÃ¡ng      | 1            | 500000      | 10            | GÃ³i VIP     |
| CÆ°á»›c Hosting        | ThÃ¡ng      | 2            | 200000      | 10            |             |
| Domain .vn          | NÄƒm        | 1            | 400000      | 0             |             |

**CÃ¡c bÆ°á»›c:**
1. Chuáº©n bá»‹ file Excel theo format trÃªn
2. KÃ©o tháº£ file vÃ o vÃ¹ng "Drag & Drop"
   - HOáº¶C click "Chá»n file Excel" Ä‘á»ƒ browse
3. Há»‡ thá»‘ng tá»± Ä‘á»™ng parse â†’ hiá»ƒn thá»‹ trong báº£ng
4. Kiá»ƒm tra vÃ  chá»‰nh sá»­a náº¿u cáº§n

#### âŒ¨ï¸ CÃ¡ch 2: Nháº­p Thá»§ CÃ´ng

**Click vÃ o Ã´ Ä‘á»ƒ chá»‰nh sá»­a:**
- GÃµ tÃªn hÃ ng hÃ³a
- Äiá»n sá»‘ lÆ°á»£ng, Ä‘Æ¡n giÃ¡
- Chá»n thuáº¿ suáº¥t: 0%, 5%, 8%, 10%
- **ThÃ nh tiá»n tá»± Ä‘á»™ng tÃ­nh** âœ¨

**Thao tÃ¡c:**
- â• **ThÃªm dÃ²ng**: Click nÃºt "ThÃªm dÃ²ng"
- ğŸ—‘ï¸ **XÃ³a dÃ²ng**: Click icon thÃ¹ng rÃ¡c á»Ÿ má»—i dÃ²ng

### D. Xem Tá»•ng Há»£p (Section C - Summary)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Tá»”NG Há»¢P BÃO GIÃ                              â”‚
â”‚                                                  â”‚
â”‚ Tá»•ng tiá»n hÃ ng:    1.100.000 â‚«                  â”‚
â”‚ Tá»•ng tiá»n thuáº¿:      110.000 â‚«                  â”‚
â”‚ CÃ´ng ná»£ trÆ°á»›c:       500.000 â‚«                  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚ Tá»”NG Cá»˜NG:       1.710.000 â‚«  [ğŸ’°]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**LÆ°u Ã½:** Sá»‘ liá»‡u cáº­p nháº­t **real-time** khi báº¡n thay Ä‘á»•i báº¥t ká»³ giÃ¡ trá»‹ nÃ o!

### E. LÆ°u Báº£ng KÃª

**2 lá»±a chá»n:**

1. **ğŸ’¾ LÆ°u nhÃ¡p**
   - LÆ°u Ä‘á»ƒ chá»‰nh sá»­a sau
   - Tráº¡ng thÃ¡i: "Dá»± tháº£o"

2. **ğŸ“¤ LÆ°u & Káº¿t xuáº¥t**
   - LÆ°u vÃ  táº¡o hÃ³a Ä‘Æ¡n Ä‘iá»‡n tá»­
   - Chuyá»ƒn sang tráº¡ng thÃ¡i "ÄÃ£ táº¡o hÃ³a Ä‘Æ¡n"

---

## ğŸ“ Quy Táº¯c Validation

### âœ… Báº¯t Buá»™c
- KhÃ¡ch hÃ ng
- Ká»³ cÆ°á»›c
- Ãt nháº¥t 1 dÃ²ng hÃ ng hÃ³a

### ğŸ”¢ Sá»‘ Liá»‡u
- **Sá»‘ lÆ°á»£ng**: â‰¥ 0
- **ÄÆ¡n giÃ¡**: â‰¥ 0
- **Thuáº¿ suáº¥t**: Chá»‰ nháº­n 0, 5, 8, 10
  - Nháº­p sá»‘ khÃ¡c â†’ tá»± Ä‘á»™ng lÃ m trÃ²n Ä‘áº¿n giÃ¡ trá»‹ gáº§n nháº¥t

### ğŸ“‹ VÄƒn Báº£n
- TÃªn hÃ ng hÃ³a: Tá»± Ä‘á»™ng trim khoáº£ng tráº¯ng
- ÄÆ¡n vá»‹: Máº·c Ä‘á»‹nh "CÃ¡i"
- Ghi chÃº: KhÃ´ng báº¯t buá»™c

---

## ğŸ¨ Thiáº¿t Káº¿ & UX

### MÃ u Sáº¯c
- **Primary**: #1976d2 (Blue)
- **Background**: #f5f5f5 (Light Gray)
- **Paper**: White vá»›i border #e0e0e0
- **Hover**: #e3f2fd (Light Blue)

### Hiá»‡u á»¨ng
- Drag & drop: Border color thay Ä‘á»•i khi hover
- Auto-fetch: Loading spinner
- Save: Snackbar notification
- Edit: Cell highlight khi focus

### Icons
- ğŸ’¾ Save: LÆ°u nhÃ¡p
- ğŸ“¤ Publish: LÆ°u & Káº¿t xuáº¥t
- â˜ï¸ Upload: Import Excel
- ğŸ”„ Autorenew: Táº£i cÃ´ng ná»£
- â• Add: ThÃªm dÃ²ng
- ğŸ—‘ï¸ Delete: XÃ³a dÃ²ng

---

## ğŸ”§ Tá»‘i Æ¯u Ká»¹ Thuáº­t

### Performance
```typescript
// 1. Memoization cho calculations
const calculations = useMemo(() => {
  const totalGoods = items.reduce((sum, item) => sum + item.amount, 0)
  const totalVAT = items.reduce((sum, item) => sum + (item.amount * item.vatRate) / 100, 0)
  return { totalGoods, totalVAT, grandTotal: totalGoods + totalVAT + previousDebt }
}, [items, previousDebt])

// 2. useCallback cho event handlers
const handleProcessRowUpdate = useCallback((newRow, oldRow) => {
  // Auto-calculate amount
  return { ...newRow, amount: newRow.quantity * newRow.unitPrice }
}, [])

// 3. DataGrid processRowUpdate
<DataGrid
  processRowUpdate={handleProcessRowUpdate}
  onProcessRowUpdateError={handleProcessRowUpdateError}
/>
```

### Validation Helpers
```typescript
// Parse number an toÃ n
const parseNumber = (value: string | number): number => {
  if (typeof value === 'number') return value
  const parsed = parseFloat(value)
  return isNaN(parsed) ? 0 : parsed
}

// Normalize VAT rate
const normalizeVatRate = (rate: number): number => {
  const validRates = [0, 5, 8, 10]
  return validRates.reduce((prev, curr) => 
    Math.abs(curr - rate) < Math.abs(prev - rate) ? curr : prev
  )
}
```

### Excel Import
```typescript
// XLSX.read() + sheet_to_json()
const workbook = XLSX.read(data, { type: 'array' })
const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 })

// Filter empty rows
const importedItems = jsonData
  .slice(1)  // Skip header
  .filter(row => row && row[0])  // Only rows with item name
  .map(row => ({ /* mapping logic */ }))
```

---

## ğŸ› Xá»­ LÃ½ Lá»—i

### Lá»—i ThÆ°á»ng Gáº·p

1. **"File Excel khÃ´ng cÃ³ dá»¯ liá»‡u"**
   - NguyÃªn nhÃ¢n: File chá»‰ cÃ³ header, khÃ´ng cÃ³ data
   - Giáº£i phÃ¡p: ThÃªm Ã­t nháº¥t 1 dÃ²ng dá»¯ liá»‡u

2. **"KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u há»£p lá»‡"**
   - NguyÃªn nhÃ¢n: Cá»™t A (TÃªn hÃ ng hÃ³a) trá»‘ng
   - Giáº£i phÃ¡p: Äiá»n tÃªn hÃ ng hÃ³a á»Ÿ cá»™t A

3. **"Lá»—i khi Ä‘á»c file Excel"**
   - NguyÃªn nhÃ¢n: File bá»‹ lá»—i format
   - Giáº£i phÃ¡p: Kiá»ƒm tra file .xlsx há»£p lá»‡

4. **"Pháº£i cÃ³ Ã­t nháº¥t 1 dÃ²ng dá»¯ liá»‡u"**
   - NguyÃªn nhÃ¢n: XÃ³a dÃ²ng cuá»‘i cÃ¹ng
   - Giáº£i phÃ¡p: LuÃ´n giá»¯ Ã­t nháº¥t 1 dÃ²ng

---

## ğŸ“¦ Dependencies

```json
{
  "dependencies": {
    "@mui/material": "^7.3.4",
    "@mui/x-data-grid": "^8.x",
    "@mui/x-date-pickers": "^7.x",
    "dayjs": "^1.11.x",
    "react-router-dom": "^6.x",
    "xlsx": "^0.18.x"
  }
}
```

---

## ğŸ¯ Roadmap TÆ°Æ¡ng Lai

### Phase 2 (Coming Soon)
- [ ] Export to Excel
- [ ] Print preview PDF
- [ ] Email gá»­i báº£ng kÃª
- [ ] Duplicate statement
- [ ] Statement templates

### Phase 3
- [ ] Multi-currency support
- [ ] Custom VAT rates
- [ ] Batch operations
- [ ] Advanced search/filter

---

## ğŸ“ Há»— Trá»£

**Gáº·p váº¥n Ä‘á»?**
- Kiá»ƒm tra console log (F12)
- Xem snackbar notifications
- LiÃªn há»‡: support@eims-kns.vn

---

**ğŸ‰ ChÃºc báº¡n sá»­ dá»¥ng hiá»‡u quáº£!**
